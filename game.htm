<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hercules: The Twelve Tasks</title>
    <style>
        /* CSS RESET */
        * { box-sizing: border-box; }
        body { 
            background-color: #000; 
            margin: 0; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            font-family: 'Courier New', monospace;
            overflow: hidden;
        }

        /* THE SCREEN */
        #game-screen {
            position: relative;
            width: 800px;
            height: 400px;
            background-color: #0000aa; /* Brighter NES Blue */
            border: 10px solid #fff;
            image-rendering: pixelated;
        }

        /* THE SCROLL OVERLAY */
        #intro-layer {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            display: flex; justify-content: center; align-items: center;
            z-index: 999;
        }

        #scroll {
            background: #e3c58d;
            width: 80%;
            padding: 25px;
            border: 6px solid #5d2e0a;
            box-shadow: 10px 10px 0px #000;
            text-align: center;
        }

        #intro-text { color: #331a00; font-size: 18px; font-weight: bold; line-height: 1.5; }

        #start-button {
            background: #f00; color: #fff; border: 4px solid #000;
            padding: 12px 24px; font-size: 22px; cursor: pointer;
            font-family: inherit; font-weight: bold; margin-top: 15px;
            display: none; /* Shows after typing */
        }

        /* HERCULES SPRITE */
        #hercules {
            position: absolute; bottom: 40px; left: 50px;
            width: 45px; height: 75px;
            background: #ffcc99; /* Skin */
            border-top: 18px solid #4a2c1d; /* Hair/Helmet */
            border-bottom: 25px solid #8b4513; /* Tunic */
            border-left: 4px solid #000; border-right: 4px solid #000;
            z-index: 10;
        }

        /* LION SPRITE */
        #lion {
            position: absolute; bottom: 40px; right: 80px;
            width: 130px; height: 90px;
            background: #d4a017; /* Gold body */
            border-left: 35px solid #804000; /* Giant Mane */
            border-top: 10px solid #804000;
            box-shadow: 5px 5px 0px #000;
        }

        #ground {
            position: absolute; bottom: 0; width: 100%; height: 40px;
            background: #5d2e0a; border-top: 5px solid #00ff00;
        }

        #ui-hp {
            position: absolute; top: 20px; right: 20px;
            width: 250px; height: 25px; border: 4px solid #fff;
            background: #222; display: none;
        }
        #hp-bar { width: 100%; height: 100%; background: #ff0000; }

        .punch-anim { transform: scaleX(1.3) translateX(10px); background: #fff !important; }
        .hide { display: none !important; }
    </style>
</head>
<body>

    <div id="game-screen">
        <div id="intro-layer">
            <div id="scroll">
                <p id="intro-text"></p>
                <button id="start-button" onclick="launchGame()">START</button>
            </div>
        </div>

        <div id="ui-hp"><div id="hp-bar"></div></div>
        <div id="hercules"></div>
        <div id="lion"></div>
        <div id="ground"></div>
    </div>

    <script>
        const story = "Welcome champion, you have selected to complete twelve tasks. But be warned: these are tasks no mortal man could complete.";
        const textDisplay = document.getElementById("intro-text");
        const startBtn = document.getElementById("start-button");
        const player = document.getElementById("hercules");
        const healthBar = document.getElementById("hp-bar");

        let index = 0;
        let hX = 50; let hY = 0; let vY = 0;
        let isGrounded = true;
        let lionHP = 100;
        let isPlaying = false;

        // 1. TYPING EFFECT
        function typeEffect() {
            if (index < story.length) {
                textDisplay.innerHTML += story.charAt(index);
                index++;
                setTimeout(typeEffect, 40);
            } else {
                startBtn.style.display = "inline-block";
            }
        }

        // 2. LAUNCH
        function launchGame() {
            document.getElementById("intro-layer").classList.add("hide");
            document.getElementById("ui-hp").style.display = "block";
            isPlaying = true;
            loop();
        }

        // 3. INPUTS
        const keysPressed = {};
        window.addEventListener("keydown", e => {
            keysPressed[e.code] = true;
            if (e.code === "Space") attack();
            if (e.code === "ArrowUp" && isGrounded) {
                vY = 18;
                isGrounded = false;
            }
        });
        window.addEventListener("keyup", e => keysPressed[e.code] = false);

        function attack() {
            if (!isPlaying) return;
            player.classList.add("punch-anim");
            
            // Check Hitbox
            let lionX = 800 - 80 - 130;
            let dist = Math.abs(hX - lionX);
            if (dist < 120 && hY < 60) {
                lionHP -= 10;
                healthBar.style.width = lionHP + "%";
                if (lionHP <= 0) {
                    isPlaying = false;
                    alert("THE NEMEAN LION DEFEATED! On to the Hydra!");
                    location.reload();
                }
            }
            setTimeout(() => player.classList.remove("punch-anim"), 150);
        }

        // 4. MAIN GAME LOOP
        function loop() {
            if (!isPlaying) return;

            if (keysPressed["ArrowRight"]) hX += 7;
            if (keysPressed["ArrowLeft"]) hX -= 7;

            // Gravity
            if (!isGrounded) {
                hY += vY;
                vY -= 1.1; 
                if (hY <= 0) {
                    hY = 0;
                    isGrounded = true;
                    vY = 0;
                }
            }

            // Constraints
            if (hX < 0) hX = 0;
            if (hX > 750) hX = 750;

            player.style.left = hX + "px";
            player.style.bottom = (40 + hY) + "px";

            requestAnimationFrame(loop);
        }

        window.onload = typeEffect;
    </script>
</body>
</html>
